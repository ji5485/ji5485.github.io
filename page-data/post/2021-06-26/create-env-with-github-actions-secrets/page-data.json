{
    "componentChunkName": "component---src-page-template-blog-post-item-template-tsx",
    "path": "/post/2021-06-26/create-env-with-github-actions-secrets/",
    "result": {"data":{"markdownRemark":{"html":"<h3 id=\"이-방법이-필요한-때는-언제일까\" style=\"position:relative;\"><a href=\"#%EC%9D%B4-%EB%B0%A9%EB%B2%95%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C-%EB%95%8C%EB%8A%94-%EC%96%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\" aria-label=\"이 방법이 필요한 때는 언제일까 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이 방법이 필요한 때는 언제일까?</h3>\n<p>결론부터 말하자면 소스코드를 <strong>Github Actions을 통해 Push 이벤트가 발생</strong>하면 Surge나 Netlify 등의 <strong>호스팅 서비스에 배포하는 Action이 트리거하기 위한 경우</strong>에 필요합니다.</p>\n<p>위에서 언급한 호스팅 서비스 외의 개인 서버에도 배포하기 위해서 이 방법이 필요할 수도 있습니다.</p>\n<p><code class=\"language-text\">process.env.[환경 변수 이름]</code> 으로 접근 가능한 환경 변수는 일반적으로 루트 디렉토리에 <code class=\"language-text\">.env</code> 등의 파일로 저장을 합니다.</p>\n<p>이런 환경 변수는 단순히 도메인 주소나 서버 포트 넘버, 디버그 상태와 같은 서버 관련 정보일 수도 있지만, 데이터베이스 계정 정보, 각종 오픈 API의 KEY 값 등 <strong>민감한 정보</strong>일 가능성이 존재합니다.</p>\n<p>물론 프론트엔드에서의 <code class=\"language-text\">create-react-app</code> 라이브러리 같은 경우에는 빌드 파일에 프로덕션 단계에서 사용하는 환경 변수를 모두 포함하기 때문에 아예 민감한 정보는 환경 변수로 추가하면 안되지만, 다른 경우에서는 충분히 민감한 정보를 환경 변수로 추가해서 사용할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># 아래와 같은 정보는 탈취되면 악용될 수 있습니다.\nREACT_APP_KAKAO_API_KEY=...\nREACT_APP_NAVER_API_KEY=...</code></pre></div>\n<p>이런 환경 변수가 Github와 같은 원격 소스코드 저장소에 저장되기라도 한다면 어떻게 될까요?</p>\n<p>누구든지 이런 민감한 개인 정보를 볼 수 있고, 만약 악의를 가진 사람이라면 언제든지 악용할 수 있습니다.</p>\n<p>그래서 저희는 대부분 <code class=\"language-text\">.gitignore</code> 라는 파일을 통해 이런 <strong>환경 변수 파일을 제외</strong>하도록 설정합니다.</p>\n<p>아래 코드는 <code class=\"language-text\">create-react-app</code> 을 통해 React 애플리케이션을 생성했을 때, 같이 만들어지는 <code class=\"language-text\">.gitignore</code> 파일의 일부분을 가져온 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">...\n\n# misc\n.DS_Store\n.env.local\n.env.development.local\n.env.test.local\n.env.production.local\n\n...</code></pre></div>\n<p>결국 이 파일에 의해 환경 변수는 로컬 개발 환경에서만 사용이 가능하고, 배포 시에는 <code class=\"language-text\">.env</code> 파일 없이 배포되기 때문에 환경 변수를 사용할 수 없습니다.</p>\n<p><strong>보안 문제로 환경 변수 파일을 Github에 업로드할 수는 없지만, 배포를 하려면 환경 변수 파일이 업로드되어야 하기 마련이죠.</strong></p>\n<p>이런 상황에서는 어떻게 문제를 해결할 수 있을까요?</p>\n<h3 id=\"github-actions의-secrets\" style=\"position:relative;\"><a href=\"#github-actions%EC%9D%98-secrets\" aria-label=\"github actions의 secrets permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Github Actions의 Secrets</h3>\n<p>Github Repository의 Actions Secrets은 환경 변수를 암호화해서 저장할 수 있는 기능입니다.</p>\n<p>해당 기능은 Actions를 트리거할 때, 환경 변수를 가져오기 위해 사용할 수 있습니다.</p>\n<p>그럼 로컬 개발 환경에서는 <code class=\"language-text\">.env</code> 파일을 통해 환경 변수에 접근하고, Github Actions에서 배포할 때에는 Actions Secrets을 통해 환경 변수에 접근할 수 있지 않을까요?</p>\n<br />\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \n        width: 100%;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\n      \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7de3881e0e0a1ffb203c412ed54c0823/9a87a/create-env-with-github-actions-secrets-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB20lEQVQ4y3VTa3PTMBDMD2sZmk4hhRZKgQ/8fmiwI9vxQ6e3vMydEjfuDJrZWZ1krW9Pp8394zO2Hx9wvd3h3e0On7484/7xGz5//Y6Hp5+43T3g6uYO19sPBTcFV+/vFnDMGk8/fmHzUrX4s+/we9+hVh1U0+KgCmrVCKuW18sez9uuR1UrVPUBB9WgPijUh8KblBJiSmB23iPEhBAinA+IKSPnWZBSFuR5xuXg+LwUY8KGJ92xxzBOIsaLwzCiqmq0bQtjDKZpAlFhTQRjLJyzEqumARkjgt77IjhpwrEfJCsWJWMl7odRftT3Q2GOJwNyUVz4UJgz5xFCeM1Qkyl2Y4JzXg4b6+SQwIeFuTTGnsqTsvBKkA+PmmSDD83zjBgjnHNiqVYt9pUSvFQKf+tGLoOtssh8KuJKcNJmJcjIOQv7mOFChmOOHJeL4P10+ua/GTKMtWi6o9TSh/Rq+wLOr3klaInE4rlFfPDoaYTxtrRMzks23CZcY7bLNTaaEL0/tU0sgqO2YosHZx9zAgUDG9xiB5hX1qy1ImzJIIVQejLnc9sYaLKlDeTmIkanF8FLlH4L0ovWORgiJP9GUCyQkRcjlmPAYKflVbwV5NvXmqTGNGmkk2UW/AdKXMzj953R9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7de3881e0e0a1ffb203c412ed54c0823/a59e9/create-env-with-github-actions-secrets-1.webp 192w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/0ca9f/create-env-with-github-actions-secrets-1.webp 384w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/dc9b9/create-env-with-github-actions-secrets-1.webp 768w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/e2c2f/create-env-with-github-actions-secrets-1.webp 1152w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/7d8ad/create-env-with-github-actions-secrets-1.webp 1521w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7de3881e0e0a1ffb203c412ed54c0823/3b721/create-env-with-github-actions-secrets-1.png 192w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/66595/create-env-with-github-actions-secrets-1.png 384w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/fe486/create-env-with-github-actions-secrets-1.png 768w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/d2d74/create-env-with-github-actions-secrets-1.png 1152w,\n/static/7de3881e0e0a1ffb203c412ed54c0823/9a87a/create-env-with-github-actions-secrets-1.png 1521w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7de3881e0e0a1ffb203c412ed54c0823/fe486/create-env-with-github-actions-secrets-1.png\"\n            alt=\"./create-env-with-github-actions-secrets-1.png\"\n            title=\"./create-env-with-github-actions-secrets-1.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<br />\n<p>그래서 저희는 <code class=\"language-text\">.env</code> 파일에 존재하는 환경 변수 중, 프로덕션 단계에서 필요한 변수를 Actions Secrets에 추가하고 Action이 트리거 될 때 자동으로 프로덕션 환경을 위한 환경 변수 파일을 생성해주도록 하겠습니다.</p>\n<h3 id=\"action에서-secrets으로-환경-변수-파일-생성하기\" style=\"position:relative;\"><a href=\"#action%EC%97%90%EC%84%9C-secrets%EC%9C%BC%EB%A1%9C-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"action에서 secrets으로 환경 변수 파일 생성하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Action에서 Secrets으로 환경 변수 파일 생성하기</h3>\n<p><a href=\"https://ji5485.github.io/post/2021-06-06/build-ci-cd-pipeline-using-github-actions/\" target=\"_blank\" rel=\"nofollow\">지난 포스트</a>에서는 React 애플리케이션을 어떻게 Github Actions로 Surge 배포하는지 알아보았었습니다.</p>\n<p>배포할 플랫폼은 어디든지 상관 없기 때문에 여기에서는 해당 예시를 그대로 가져와 사용해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Automatically Deployment\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">deployment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token comment\"># 해당 Job의 이름을 아래와 같이 설정하여 Actions 탭에서 확인할 수 있게 설정합니다.</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploying to surge\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># 해당 레포지토리로 check-out하는 Action을 불러왔습니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n      <span class=\"token comment\"># Node 환경을 설정하여 npm 커맨드를 사용할 수 있도록 하는 Action을 불러옵니다.</span>\n      <span class=\"token comment\"># 여기에서는 14 버전을 사용하고 있습니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'14'</span>\n\n      <span class=\"token comment\"># 해당 프로젝트에서 사용하는 모든 라이브러리와 Surge를 설치합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install Dependencies and Surge\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          npm install\n          npm install surge --global</span>\n\n      <span class=\"token comment\"># React 프로젝트를 빌드합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build React Application\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token comment\"># Surge에 빌드된 파일을 배포합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy React Application to Surge\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> surge ./build $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SURGE_DOMAIN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>token $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SURGE_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 코드는 지난 포스트에서 작성했던 Action 코드입니다.</p>\n<p>먼저 저희에게 다음과 같은 환경 변수가 있다고 가정해봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># .env 파일에 저장된 환경 변수\nREACT_APP_DOMAIN=https://domain.co.kr\nREACT_APP_DEBUG=false</code></pre></div>\n<p>저희는 위의 환경 변수를 프로젝트의 라이브러리를 설치하기 전에 추가해보겠습니다.</p>\n<p>그러기 위해서 Github Repository의 Secrets으로 위의 환경 변수를 추가해줘야 합니다.</p>\n<p>아래 사진과 같이 두 개의 Secret을 생성해준 다음, Action 파일을 수정해보겠습니다.</p>\n<br />\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \n        width: 100%;\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\n      \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/769dbbee95cb77180b72de1f336c42f9/9a87a/create-env-with-github-actions-secrets-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABiklEQVQ4y41T224bIRD1hyVV4ygXN07S2kpf+q95zkse+wFVm2jX7BUDCwxwKtj1yo5txSMdDTvMHA7D7GR2v8T0Zo7z6S2+XN7i28MCs/sfuHtcYv79CZc3c5x9vcL59LrHRY8Y2yDGp9d3WPz8hclbVuLfe4W/7xVyVoEVJVasGMGKCkVZg5XVsK5Q1g2ynCHLV8hZgWzFkK+K9D1xzoGcQ/TaGFhyMOShrYOxDlobGGtT3FpKucfMEmESF1XdouXrVETkUHMF1mo0QqNpW6iuQwAQQtiCR/A+eZ98gDGmJ1wLibrh0KZX0nUdpJIpIQSkgqjM+5CUxGJsgP6AaCNhVTcQUvXXIgchJHjLxytG1eSOYNjbIWxaDi7kSBh7JpSCMRbG0qeINXuEa6EGMtpqsvsURwmjQkMOwQGv2W88/3kZ2hTgdx7jMHYIOylBRKnpwQdwI1DrFqfbB0IudJq98QU3aScoO6gw9k/IbugH7SVuH3JQ37BPm8GOf4NUapg1fzLRR8JY+x/Yw9J2pnDTAQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/769dbbee95cb77180b72de1f336c42f9/a59e9/create-env-with-github-actions-secrets-2.webp 192w,\n/static/769dbbee95cb77180b72de1f336c42f9/0ca9f/create-env-with-github-actions-secrets-2.webp 384w,\n/static/769dbbee95cb77180b72de1f336c42f9/dc9b9/create-env-with-github-actions-secrets-2.webp 768w,\n/static/769dbbee95cb77180b72de1f336c42f9/e2c2f/create-env-with-github-actions-secrets-2.webp 1152w,\n/static/769dbbee95cb77180b72de1f336c42f9/7d8ad/create-env-with-github-actions-secrets-2.webp 1521w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/769dbbee95cb77180b72de1f336c42f9/3b721/create-env-with-github-actions-secrets-2.png 192w,\n/static/769dbbee95cb77180b72de1f336c42f9/66595/create-env-with-github-actions-secrets-2.png 384w,\n/static/769dbbee95cb77180b72de1f336c42f9/fe486/create-env-with-github-actions-secrets-2.png 768w,\n/static/769dbbee95cb77180b72de1f336c42f9/d2d74/create-env-with-github-actions-secrets-2.png 1152w,\n/static/769dbbee95cb77180b72de1f336c42f9/9a87a/create-env-with-github-actions-secrets-2.png 1521w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/769dbbee95cb77180b72de1f336c42f9/fe486/create-env-with-github-actions-secrets-2.png\"\n            alt=\"./create-env-with-github-actions-secrets-2.png\"\n            title=\"./create-env-with-github-actions-secrets-2.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<br />\n<p>환경 변수를 추가해주었으니 이제 Action 파일을 수정해봅시다.</p>\n<p>이를 위해 <code class=\"language-text\">uses: actions/setup-node@v2</code> 와 <code class=\"language-text\">name: Install Dependencies and Surge</code> 사이에 환경 변수를 생성하는 Step을 추가해줘야 합니다.</p>\n<p>따라서 아래와 같이 YAML 파일을 변경해주세요.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Automatically Deployment\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">deployment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token comment\"># 해당 Job의 이름을 아래와 같이 설정하여 Actions 탭에서 확인할 수 있게 설정합니다.</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploying to surge\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># 해당 레포지토리로 check-out하는 Action을 불러왔습니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n      <span class=\"token comment\"># Node 환경을 설정하여 npm 커맨드를 사용할 수 있도록 하는 Action을 불러옵니다.</span>\n      <span class=\"token comment\"># 여기에서는 14 버전을 사용하고 있습니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'14'</span>\n\n      <span class=\"token comment\"># Github Repository Secrets를 통해 환경 변수 파일을 생성합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Generate Environment Variables File for Production\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span>\n\n      <span class=\"token comment\"># 해당 프로젝트에서 사용하는 모든 라이브러리와 Surge를 설치합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install Dependencies and Surge\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          npm install\n          npm install surge --global</span>\n\n      <span class=\"token comment\"># React 프로젝트를 빌드합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build React Application\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token comment\"># Surge에 빌드된 파일을 배포합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy React Application to Surge\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> surge ./build $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SURGE_DOMAIN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>token $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SURGE_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>다음 단계로 진행하기 위해서는 간단한 리눅스 명령어의 사용법을 알아야 합니다.</p>\n<p>여기서 사용할 명령어는 <code class=\"language-text\">echo</code> 인데요, 해당 명령어는 콘솔 창에 인수로 받은 문자열을 출력하는 아주 단순한 명령어입니다.</p>\n<p>하지만 옵션을 추가하면 인수로 받은 문자열을 콘솔 창이 아닌 파일에 저장할 수 있습니다.</p>\n<p>아래의 커맨드는 문자열을 <code class=\"language-text\">test.txt</code> 파일에 저장하는 커맨드입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Hello, World!\"</span> <span class=\"token operator\">>></span> test.txt</code></pre></div>\n<p>만약 <code class=\"language-text\">test.txt</code> 파일이 존재하지 않는다면, 파일을 생성한 후 문자열을 입력하게 됩니다.</p>\n<p>저희는 이 명령어를 통해 Generate Environment Variables File for Production 단계에서 환경 변수 파일을 생성해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Automatically Deployment\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">deployment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token comment\"># 해당 Job의 이름을 아래와 같이 설정하여 Actions 탭에서 확인할 수 있게 설정합니다.</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploying to surge\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># 해당 레포지토리로 check-out하는 Action을 불러왔습니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n      <span class=\"token comment\"># Node 환경을 설정하여 npm 커맨드를 사용할 수 있도록 하는 Action을 불러옵니다.</span>\n      <span class=\"token comment\"># 여기에서는 14 버전을 사용하고 있습니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'14'</span>\n\n      <span class=\"token comment\"># Github Repository Secrets를 통해 환경 변수 파일을 생성합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Generate Environment Variables File for Production\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          echo \"REACT_APP_DOMAIN=$REACT_APP_DOMAIN\" >> .env.production\n          echo \"REACT_APP_DEBUG=$REACT_APP_DEBUG\" >> .env.production</span>\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">REACT_APP_DOMAIN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.REACT_APP_DOMAIN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">REACT_APP_DEBUG</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.REACT_APP_DEBUG <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\"># 해당 프로젝트에서 사용하는 모든 라이브러리와 Surge를 설치합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install Dependencies and Surge\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          npm install\n          npm install surge --global</span>\n\n      <span class=\"token comment\"># React 프로젝트를 빌드합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build React Application\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token comment\"># Surge에 빌드된 파일을 배포합니다.</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy React Application to Surge\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> surge ./build $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SURGE_DOMAIN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>token $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SURGE_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>기본적으로 echo 명령어를 통해 변수를 출력하려면 변수명 앞에 <code class=\"language-text\">$</code>를 붙여줘야 하는데, 만약 다음과 같이 <code class=\"language-text\">env</code> 옵션을 설정하지 않는다면 Runner는 해당 변수를 찾지 못해 올바르게 환경 변수를 설정할 수 없습니다.</p>\n<p>따라서 해당 옵션을 통해 어떤 변수에 어떤 값이 들어갈지 설정해줘야 합니다.</p>\n<p>이렇게 <code class=\"language-text\">.env</code> 파일의 업로드 없이, 환경 변수를 설정한 상태에서 배포가 가능합니다.</p>","frontmatter":{"title":"Github Actions에서 Secrets을 통해 env 파일 생성하기","date":"2021-06-26","summary":"일반적으로 Github에 업로드하지 않는 env 파일을 어떻게 Github Actions에서 생성하고, 환경 변수를 추가할 수 있는지 알아봅시다.","categories":["Github"],"thumbnail":{"publicURL":"/static/7ddf0bb75ba3d64798b768b63d3fe1e9/create-env-with-github-actions-secrets.png","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACcUlEQVQoz1WSS2+NQRzG5513bu+8t57Taw4VNhZYWaBBnLandTtaDW04NJGG2AtdWPAdXBKRSNvEzlewsRERYsfGgqWVhVVtfsyc0nTxZCaT/zzzXEakWtOHIlWKSlkq5xkoa2xZYbOMNJVImZAkAiklMk2RSYLVBp95Mudw1mBTifhPqNQ2wrAQCO1IfIkvKsqipMgLRDjfQiANUFLijMbpdCeh0gqRJDSbTTrTM8zNz3P4yFFUlqO1pSwKTpw4ybnuRRbmzjJQV1Ghdw6TSrRMdhJqY+LL7clTvPkOP37D+vp6JOp2L5BpwavXH9j4DO++bbJ/326ENFRFQVnkFD5D/LMZcjHORcIL0x1+bMKX3/D0xQZl7lldXcU7y9v3n/j4C77+hL3jrThvtcKqlMyobcK+ZR0HDh04yNraGs83XrJy8xYyCZcSUil4+OA+j56t8eTJY0aGh9FKkfsMq2Sc26nQWpTRJLFJ+T98Y3REaLKvKI2XVchNpaRhL/sFCRnJ+oRJOBAiljLV6XDmfJeZ2VkmJiZot9ucnj3NZLvN8nKPhYU5GnWDKi+oqzLGkmcuKOzbHGu16ExOcfzoMWYmp1i5dZvejRXu3L3H4uISF+fnmTh2hF5vieXrV5jrnuNq7xqLly8xPdVmqNlABkdRmZQxv6CsqmuaVU2rtYs9e/YyvnucocEhBhs1jSpnoCoYGx2l2WgwNjrC0GCT3LsYQ/g6IpGBMA2b7U+7ZT2GLEQswyiJtyqGH+CsJpX9IoxW5M7ig+Wg7h9COZnSFMZhjMFaS+E9ZR5WgzMqllB4R6OqGKwrBuqSPPexMP1X4R87HEUWlEDN9QAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/7ddf0bb75ba3d64798b768b63d3fe1e9/0f157/create-env-with-github-actions-secrets.png","srcSet":"/static/7ddf0bb75ba3d64798b768b63d3fe1e9/c7aa3/create-env-with-github-actions-secrets.png 192w,\n/static/7ddf0bb75ba3d64798b768b63d3fe1e9/cff52/create-env-with-github-actions-secrets.png 384w,\n/static/7ddf0bb75ba3d64798b768b63d3fe1e9/0f157/create-env-with-github-actions-secrets.png 768w","sizes":"(min-width: 768px) 768px, 100vw"},"sources":[{"srcSet":"/static/7ddf0bb75ba3d64798b768b63d3fe1e9/04b43/create-env-with-github-actions-secrets.webp 192w,\n/static/7ddf0bb75ba3d64798b768b63d3fe1e9/7efec/create-env-with-github-actions-secrets.webp 384w,\n/static/7ddf0bb75ba3d64798b768b63d3fe1e9/803f0/create-env-with-github-actions-secrets.webp 768w","type":"image/webp","sizes":"(min-width: 768px) 768px, 100vw"}]},"width":768,"height":449.99999999999994}}}},"tableOfContents":"<ul>\n<li><a href=\"#%EC%9D%B4-%EB%B0%A9%EB%B2%95%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C-%EB%95%8C%EB%8A%94-%EC%96%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\">이 방법이 필요한 때는 언제일까?</a></li>\n<li><a href=\"#github-actions%EC%9D%98-secrets\">Github Actions의 Secrets</a></li>\n<li><a href=\"#action%EC%97%90%EC%84%9C-secrets%EC%9C%BC%EB%A1%9C-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\">Action에서 Secrets으로 환경 변수 파일 생성하기</a></li>\n</ul>"},"site":{"siteMetadata":{"siteUrl":"https://ji5485.github.io"}}},"pageContext":{"slug":"/post/2021-06-26/create-env-with-github-actions-secrets/","prev":{"slug":"/post/2021-07-26/train-map-visualizer-side-project-midterm-review/","title":"난 React로 어떤 걸 만들 수 있을까, 사이드 프로젝트 중간 점검"},"next":{"slug":"/post/2021-06-06/build-ci-cd-pipeline-using-github-actions/","title":"GitHub Actions를 이용한 CI/CD 구축하기"}}},
    "staticQueryHashes": []}